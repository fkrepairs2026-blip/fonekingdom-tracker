{
  "rules": {
    ".read": false,
    ".write": false,
    
    "repairs": {
      ".indexOn": ["status", "technicianId", "createdAt"],
      ".read": "auth != null",
      "$repairId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'manager' ||
          root.child('users').child(auth.uid).child('role').val() === 'cashier' ||
          root.child('users').child(auth.uid).child('role').val() === 'technician'
        )",
        "deleted": {
          ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
        }
      }
    },
    
    "users": {
      ".read": "auth != null",
      "$userId": {
        ".write": "auth.uid === $userId || root.child('users').child(auth.uid).child('role').val() === 'admin'"
      }
    },
    
    "inventory": {
      ".read": "auth != null",
      "$itemId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'manager'
        )"
      }
    },
    
    "techExpenses": {
      ".read": "auth != null",
      "$expenseId": {
        ".write": "auth != null && root.child('users').child(auth.uid).child('role').val() === 'technician'"
      }
    },
    
    "techRemittances": {
      ".read": "auth != null",
      "$remittanceId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'technician' ||
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'cashier'
        )"
      }
    },
    
    "modificationRequests": {
      ".read": "auth != null",
      "$requestId": {
        ".write": "auth != null"
      }
    },
    
    "auditLogs": {
      ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
      "$logId": {
        ".write": "auth != null"
      }
    },
    
    "deletedRepairs": {
      ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
      "$repairId": {
        ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
      }
    },
    
    "activityLogs": {
      ".read": "auth != null",
      "$logId": {
        ".write": "auth != null"
      }
    },
    
    "loginEvents": {
      ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
      "$eventId": {
        ".write": "auth != null"
      }
    },
    
    "suppliers": {
      ".read": "auth != null",
      "$supplierId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'manager'
        )"
      }
    },
    
    "dailyCashCounts": {
      ".read": "auth != null",
      "$countId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'cashier'
        )"
      }
    },
    
    "stockMovements": {
      ".read": "auth != null",
      "$movementId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'manager'
        )"
      }
    },
    
    "dataCleanupHistory": {
      ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
      "$historyId": {
        ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
      }
    },
    
    "overheadExpenses": {
      ".read": "auth != null",
      "$expenseId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'manager'
        )"
      }
    },
    
    "refunds": {
      ".read": "auth != null",
      "$refundId": {
        ".write": "auth != null"
      }
    },
    
    "supplierPurchases": {
      ".read": "auth != null",
      "$purchaseId": {
        ".write": "auth != null && (
          root.child('users').child(auth.uid).child('role').val() === 'admin' ||
          root.child('users').child(auth.uid).child('role').val() === 'manager'
        )"
      }
    },
    
    "resetBackups": {
      ".read": "root.child('users').child(auth.uid).child('role').val() === 'admin'",
      "$backupId": {
        ".write": "root.child('users').child(auth.uid).child('role').val() === 'admin'"
      }
    }
  }
}